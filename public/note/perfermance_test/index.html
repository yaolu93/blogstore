<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title> - Yao</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Yao" /><meta name="description" content="1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 ####################Should change the firefox proxy##################### # get the password, userid is elastic kubectl -n monitoring get secret monitoring-elasticsearch-es-elastic-user -o=jsonpath=&amp;#39;{." />






<meta name="generator" content="Hugo 0.121.2 with theme even" />


<link rel="canonical" href="https://www.yaolugnu.com/note/perfermance_test/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="" />
<meta property="og:description" content="1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 ####################Should change the firefox proxy##################### # get the password, userid is elastic kubectl -n monitoring get secret monitoring-elasticsearch-es-elastic-user -o=jsonpath=&#39;{." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.yaolugnu.com/note/perfermance_test/" /><meta property="article:section" content="note" />



<meta itemprop="name" content="">
<meta itemprop="description" content="1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 ####################Should change the firefox proxy##################### # get the password, userid is elastic kubectl -n monitoring get secret monitoring-elasticsearch-es-elastic-user -o=jsonpath=&#39;{.">

<meta itemprop="wordCount" content="985">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/><meta name="twitter:title" content=""/>
<meta name="twitter:description" content="1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 ####################Should change the firefox proxy##################### # get the password, userid is elastic kubectl -n monitoring get secret monitoring-elasticsearch-es-elastic-user -o=jsonpath=&#39;{."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">yao lu</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/cv/">
        <li class="mobile-menu-item">CV</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">yao lu</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/cv/">CV</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
  <div class="post-content">
    <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################Should change the firefox proxy#####################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># get the password, userid is elastic</span>
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="o">-</span><span class="n">n</span> <span class="n">monitoring</span> <span class="n">get</span> <span class="n">secret</span> <span class="n">monitoring</span><span class="o">-</span><span class="n">elasticsearch</span><span class="o">-</span><span class="n">es</span><span class="o">-</span><span class="n">elastic</span><span class="o">-</span><span class="n">user</span> <span class="o">-</span><span class="n">o</span><span class="o">=</span><span class="n">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.data.elastic}&#39;</span> <span class="o">|</span> <span class="n">base64</span> <span class="o">--</span><span class="n">decode</span><span class="p">;</span> <span class="n">echo</span>
</span></span><span class="line"><span class="cl"><span class="c1"># do port forwarding on your dev-vm</span>
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">port</span><span class="o">-</span><span class="n">forward</span> <span class="o">--</span><span class="n">address</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span> <span class="n">svc</span><span class="o">/</span><span class="n">gateway</span><span class="o">-</span><span class="n">proxy</span> <span class="o">-</span><span class="n">n</span>  <span class="n">monitoring</span> <span class="mi">30090</span><span class="p">:</span><span class="mi">80</span>
</span></span><span class="line"><span class="cl"><span class="mf">10.15</span><span class="o">.</span><span class="mf">32.90</span><span class="p">:</span><span class="mi">30090</span><span class="o">/</span><span class="n">kibana</span><span class="o">/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">./</span><span class="n">perf_new</span><span class="o">/</span><span class="n">e2e_enrich_keyRange</span><span class="o">/</span><span class="n">run_test_e2e_enrich_keyRange_k8s_local</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">minikube</span> <span class="n">start</span> <span class="o">--</span><span class="n">embed</span><span class="o">-</span><span class="n">certs</span>
</span></span><span class="line"><span class="cl"><span class="n">minikube</span> <span class="n">start</span> <span class="o">--</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">version</span><span class="o">=</span><span class="mf">1.21</span><span class="o">.</span><span class="mi">0</span> <span class="o">--</span><span class="n">embed</span><span class="o">-</span><span class="n">certs</span> <span class="o">--</span><span class="n">cpus</span> <span class="mi">2</span> <span class="o">--</span><span class="n">memory</span> <span class="mi">16384</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">create</span> <span class="n">ns</span> <span class="n">cgf</span>
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">config</span> <span class="n">set</span><span class="o">-</span><span class="n">context</span> <span class="o">--</span><span class="n">current</span> <span class="o">--</span><span class="n">namespace</span><span class="o">=</span><span class="n">cgf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">./</span><span class="n">acceptance_perf_soak</span><span class="o">/</span><span class="n">perf_new</span><span class="o">/</span><span class="n">scripts</span>
</span></span><span class="line"><span class="cl"><span class="o">./</span><span class="n">start_odf_test_container_k8s</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl"><span class="o">./</span><span class="n">copy_test_files</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">apply</span> <span class="o">-</span><span class="n">f</span> <span class="o">~/</span><span class="n">workspace</span><span class="o">/</span><span class="n">ngm</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">container</span><span class="o">/</span><span class="n">resources</span><span class="o">/</span><span class="n">k8s</span><span class="o">-</span><span class="n">pods</span><span class="o">/</span><span class="n">sftp</span><span class="o">-</span><span class="n">local</span><span class="o">.</span><span class="n">yaml</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sh</span> <span class="o">~/</span><span class="n">workspace</span><span class="o">/</span><span class="n">ngm</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">container</span><span class="o">/</span><span class="n">acceptance_perf_soak</span><span class="o">/</span><span class="n">perf_new</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">deploy_strimzi_operator</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## inside acceptance_perf_soak</span>
</span></span><span class="line"><span class="cl"><span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">start_odf_test_container</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">apply</span> <span class="o">-</span><span class="n">f</span> <span class="o">~/</span><span class="n">workspace</span><span class="o">/</span><span class="n">ngm</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">container</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">k8s</span><span class="o">/</span><span class="n">odf</span><span class="o">-</span><span class="n">test</span><span class="o">.</span><span class="n">yaml</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">apply</span> <span class="o">-</span><span class="n">f</span> <span class="o">~/</span><span class="n">packages</span><span class="o">/</span><span class="n">ngm</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">container</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">k8s</span><span class="o">/</span><span class="n">odf</span><span class="o">-</span><span class="n">test</span><span class="o">.</span><span class="n">yaml</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">delete</span> <span class="o">-</span><span class="n">f</span> <span class="o">~/</span><span class="n">workspace</span><span class="o">/</span><span class="n">ngm</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">container</span><span class="o">/</span><span class="n">resources</span><span class="o">/</span><span class="n">k8s</span><span class="o">-</span><span class="n">pods</span><span class="o">/</span><span class="n">sftp</span><span class="o">.</span><span class="n">yaml</span> 
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">apply</span> <span class="o">-</span><span class="n">f</span> <span class="o">~/</span><span class="n">workspace</span><span class="o">/</span><span class="n">ngm</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">container</span><span class="o">/</span><span class="n">resources</span><span class="o">/</span><span class="n">k8s</span><span class="o">-</span><span class="n">pods</span><span class="o">/</span><span class="n">sftp</span><span class="o">.</span><span class="n">yaml</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">apply</span> <span class="o">-</span><span class="n">f</span> <span class="o">~/</span><span class="n">workspace</span><span class="o">/</span><span class="n">ngm</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">container</span><span class="o">/</span><span class="n">resources</span><span class="o">/</span><span class="n">k8s</span><span class="o">-</span><span class="n">pods</span><span class="o">/</span><span class="n">sftp</span><span class="o">-</span><span class="n">local</span><span class="o">.</span><span class="n">yaml</span> 
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">delete</span> <span class="o">-</span><span class="n">f</span> <span class="o">~/</span><span class="n">workspace</span><span class="o">/</span><span class="n">ngm</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">container</span><span class="o">/</span><span class="n">resources</span><span class="o">/</span><span class="n">k8s</span><span class="o">-</span><span class="n">pods</span><span class="o">/</span><span class="n">sftp</span><span class="o">-</span><span class="n">local</span><span class="o">.</span><span class="n">yaml</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">setup_sftp_datagen</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">docker</span>  <span class="n">exec</span> <span class="o">-</span><span class="n">it</span> <span class="n">odf_test</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&#34;export ODF_TEST_ENV=&#34;</span><span class="n">k8s</span><span class="s2">&#34;;pytest -s /app/acceptance_perf_soak/test_main_perf_collect_data.py::test_perf_collect_data_source&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="n">kubectl</span> <span class="o">-</span><span class="n">n</span> <span class="n">cgf</span> <span class="n">exec</span> <span class="o">-</span><span class="n">ti</span> <span class="n">odf</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">kafka</span><span class="o">-</span><span class="mi">0</span> <span class="o">--</span> <span class="o">./</span><span class="n">bin</span><span class="o">/</span><span class="n">kafka</span><span class="o">-</span><span class="n">console</span><span class="o">-</span><span class="n">consumer</span><span class="o">.</span><span class="n">sh</span> <span class="o">--</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">server</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">9092</span> <span class="o">--</span><span class="n">topic</span> <span class="n">streams</span><span class="o">-</span><span class="n">input</span> <span class="o">--</span><span class="n">from</span><span class="o">-</span><span class="n">beginning</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="n">kubectl</span> <span class="o">-</span><span class="n">n</span> <span class="n">cgf</span> <span class="n">exec</span> <span class="o">-</span><span class="n">ti</span> <span class="n">odf</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">kafka</span><span class="o">-</span><span class="mi">0</span> <span class="o">--</span> <span class="o">./</span><span class="n">bin</span><span class="o">/</span><span class="n">kafka</span><span class="o">-</span><span class="n">console</span><span class="o">-</span><span class="n">consumer</span><span class="o">.</span><span class="n">sh</span> <span class="o">--</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">server</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">9092</span> <span class="o">--</span><span class="n">topic</span> <span class="n">streams</span><span class="o">-</span><span class="n">output</span> <span class="o">--</span><span class="n">from</span><span class="o">-</span><span class="n">beginning</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="n">kubectl</span> <span class="o">-</span><span class="n">n</span> <span class="n">cgf</span> <span class="n">exec</span> <span class="o">-</span><span class="n">ti</span> <span class="n">odf</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">kafka</span><span class="o">-</span><span class="mi">0</span> <span class="o">--</span> <span class="o">./</span><span class="n">bin</span><span class="o">/</span><span class="n">kafka</span><span class="o">-</span><span class="n">console</span><span class="o">-</span><span class="n">consumer</span><span class="o">.</span><span class="n">sh</span> <span class="o">--</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">server</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">9092</span> <span class="o">--</span><span class="n">topic</span> <span class="n">streams</span><span class="o">-</span><span class="n">refOffers</span> <span class="o">--</span><span class="n">from</span><span class="o">-</span><span class="n">beginning</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="n">odf</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">kafka</span><span class="o">-</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">exec</span> <span class="o">-</span><span class="n">ti</span> <span class="n">odf</span><span class="o">-</span><span class="n">sftp</span><span class="o">-</span><span class="mi">0</span> <span class="o">--</span>  <span class="n">bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">/</span><span class="n">ngm</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">container</span><span class="o">/</span><span class="n">acceptance_perf_soak</span><span class="o">/</span><span class="n">scripts</span>
</span></span><span class="line"><span class="cl"> <span class="o">./</span><span class="n">acceptance_perf_soak</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">run_test_enrich_strategy_key_k8s</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="n">kubectl</span> <span class="n">exec</span> <span class="o">-</span><span class="n">ti</span> <span class="err">`</span><span class="n">kubectl</span>  <span class="n">get</span> <span class="n">pod</span> <span class="o">-</span><span class="n">l</span> <span class="n">pod</span><span class="o">/</span><span class="n">name</span><span class="o">=</span><span class="n">schema</span><span class="o">-</span><span class="n">registry</span><span class="o">-</span><span class="n">helm</span> <span class="o">|</span> <span class="n">awk</span> <span class="s1">&#39;{print $1}&#39;</span> <span class="o">|</span> <span class="n">tail</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1</span><span class="err">`</span> <span class="o">-</span><span class="n">n</span> <span class="n">cgf</span> <span class="o">-</span><span class="n">c</span> <span class="n">schema</span><span class="o">-</span><span class="n">registry</span><span class="o">-</span><span class="n">helm</span> <span class="o">--</span> <span class="n">bash</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&#34;unset JMX_PORT ; kafka-avro-console-consumer --topic streams-input --bootstrap-server odf-cluster-kafka-bootstrap:9092 --from-beginning --property print.key=true --property print.timestamp=true --property print.schema.ids=true --property print.headers=true --key-deserializer=org.apache.kafka.common.serialization.StringDeserializer&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">exec</span> <span class="o">-</span><span class="n">ti</span> <span class="err">`</span><span class="n">kubectl</span>  <span class="n">get</span> <span class="n">pod</span> <span class="o">-</span><span class="n">l</span> <span class="n">pod</span><span class="o">/</span><span class="n">name</span><span class="o">=</span><span class="n">schema</span><span class="o">-</span><span class="n">registry</span><span class="o">-</span><span class="n">helm</span> <span class="o">|</span> <span class="n">awk</span> <span class="s1">&#39;{print $1}&#39;</span> <span class="o">|</span> <span class="n">tail</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1</span><span class="err">`</span> <span class="o">-</span><span class="n">n</span> <span class="n">cgf</span> <span class="o">-</span><span class="n">c</span> <span class="n">schema</span><span class="o">-</span><span class="n">registry</span><span class="o">-</span><span class="n">helm</span> <span class="o">--</span> <span class="n">bash</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&#34;unset JMX_PORT ; kafka-avro-console-consumer --topic streams-output --bootstrap-server odf-cluster-kafka-bootstrap:9092 --from-beginning --property print.key=true --property print.timestamp=true --property print.schema.ids=true --property print.headers=true --key-deserializer=org.apache.kafka.common.serialization.StringDeserializer&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">exec</span> <span class="o">-</span><span class="n">ti</span> <span class="err">`</span><span class="n">kubectl</span>  <span class="n">get</span> <span class="n">pod</span> <span class="o">-</span><span class="n">l</span> <span class="n">pod</span><span class="o">/</span><span class="n">name</span><span class="o">=</span><span class="n">schema</span><span class="o">-</span><span class="n">registry</span><span class="o">-</span><span class="n">helm</span> <span class="o">|</span> <span class="n">awk</span> <span class="s1">&#39;{print $1}&#39;</span> <span class="o">|</span> <span class="n">tail</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1</span><span class="err">`</span> <span class="o">-</span><span class="n">n</span> <span class="n">cgf</span> <span class="o">-</span><span class="n">c</span> <span class="n">schema</span><span class="o">-</span><span class="n">registry</span><span class="o">-</span><span class="n">helm</span> <span class="o">--</span> <span class="n">bash</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&#34;unset JMX_PORT ; kafka-avro-console-consumer --topic streams-error --bootstrap-server odf-cluster-kafka-bootstrap:9092 --from-beginning --property print.key=true --property print.timestamp=true --property print.schema.ids=true --property print.headers=true --key-deserializer=org.apache.kafka.common.serialization.StringDeserializer&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">exec</span> <span class="o">-</span><span class="n">ti</span> <span class="err">`</span><span class="n">kubectl</span>  <span class="n">get</span> <span class="n">pod</span> <span class="o">-</span><span class="n">l</span> <span class="n">pod</span><span class="o">/</span><span class="n">name</span><span class="o">=</span><span class="n">schema</span><span class="o">-</span><span class="n">registry</span><span class="o">-</span><span class="n">helm</span> <span class="o">|</span> <span class="n">awk</span> <span class="s1">&#39;{print $1}&#39;</span> <span class="o">|</span> <span class="n">tail</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1</span><span class="err">`</span> <span class="o">-</span><span class="n">n</span> <span class="n">cgf</span> <span class="o">-</span><span class="n">c</span> <span class="n">schema</span><span class="o">-</span><span class="n">registry</span><span class="o">-</span><span class="n">helm</span> <span class="o">--</span> <span class="n">bash</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&#34;unset JMX_PORT ; kafka-avro-console-consumer --topic streams-input-enrich --bootstrap-server odf-cluster-kafka-bootstrap:9092 --from-beginning --property print.key=true --property print.timestamp=true --property print.schema.ids=true --property print.headers=true --key-deserializer=org.apache.kafka.common.serialization.StringDeserializer&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">k</span> <span class="n">exec</span> <span class="o">-</span><span class="n">ti</span> <span class="n">odf</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">schema</span><span class="o">-</span><span class="n">registry</span><span class="o">-</span><span class="mi">57646</span><span class="n">c6787</span><span class="o">-</span><span class="n">dk9lq</span> <span class="o">-</span><span class="n">c</span> <span class="n">schema</span><span class="o">-</span><span class="n">registry</span><span class="o">-</span><span class="n">helm</span> <span class="n">bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">unset</span> <span class="n">JMX_PORT</span> <span class="o">&amp;&amp;</span> <span class="n">kafka</span><span class="o">-</span><span class="n">avro</span><span class="o">-</span><span class="n">console</span><span class="o">-</span><span class="n">consumer</span> <span class="o">--</span><span class="n">from</span><span class="o">-</span><span class="n">beginning</span> <span class="o">--</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">server</span>  <span class="n">odf</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">kafka</span><span class="o">-</span><span class="mf">0.</span><span class="n">odf</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">kafka</span><span class="o">-</span><span class="n">brokers</span><span class="o">.</span><span class="n">kafka</span><span class="o">-</span><span class="n">external</span><span class="o">.</span><span class="n">svc</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">local</span><span class="p">:</span><span class="mi">9092</span> <span class="o">--</span><span class="n">topic</span> <span class="n">kafka</span><span class="o">-</span><span class="n">sink</span><span class="o">-</span><span class="n">output</span> <span class="o">--</span><span class="n">property</span> <span class="nb">print</span><span class="o">.</span> <span class="n">timestamp</span><span class="o">=</span><span class="bp">true</span> <span class="o">--</span><span class="n">group</span> <span class="n">connect</span><span class="o">-</span><span class="n">cluster</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">ODF_TEST_ENV</span><span class="o">=</span><span class="s2">&#34;k8s&#34;</span><span class="p">;</span><span class="n">pytest</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">acceptance_perf_soak</span><span class="o">/</span><span class="n">test_main_perf_collect_data</span><span class="o">.</span><span class="n">py</span><span class="p">::</span><span class="n">test_perf_collect_data_streamer</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">helm</span> <span class="n">list</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">get</span> <span class="n">pod</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">get</span> <span class="n">pod</span> <span class="o">-</span><span class="n">o</span> <span class="n">yaml</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">describe</span> <span class="n">pod</span> <span class="o">&lt;</span><span class="n">pod</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">logs</span> <span class="o">&lt;</span><span class="n">pod</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">get</span> <span class="n">kctr</span> <span class="p">(</span><span class="n">connector</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">get</span> <span class="n">kctr</span> <span class="o">&lt;</span><span class="n">connector</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">o</span> <span class="n">yaml</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">config</span> <span class="n">set</span><span class="o">-</span><span class="n">context</span> <span class="o">--</span><span class="n">current</span> <span class="o">--</span><span class="n">namespace</span><span class="o">=</span><span class="n">cgf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">cp</span> <span class="o">../</span><span class="n">test_lib</span><span class="o">/</span> <span class="n">cgf</span><span class="o">/</span><span class="n">odf</span><span class="o">-</span><span class="n">test</span><span class="p">:</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">cp</span> <span class="o">../</span><span class="n">acceptance_perf_soak</span><span class="o">/</span> <span class="n">cgf</span><span class="o">/</span><span class="n">odf</span><span class="o">-</span><span class="n">test</span><span class="p">:</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">cp</span> <span class="o">../</span><span class="n">acceptance_perf_soak</span><span class="o">/</span> <span class="n">odf_test</span><span class="p">:</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">cp</span> <span class="o">../</span><span class="n">test_lib</span> <span class="n">odf_test</span><span class="p">:</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">describe</span> <span class="n">pod</span> <span class="n">strimzi</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">operator</span><span class="o">-</span><span class="mi">56</span><span class="n">bcf69b8b</span><span class="o">-</span><span class="mi">22</span><span class="n">hvc</span>
</span></span><span class="line"><span class="cl"><span class="n">kubectl</span> <span class="n">logs</span> <span class="n">strimzi</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">operator</span><span class="o">-</span><span class="mi">56</span><span class="n">bcf69b8b</span><span class="o">-</span><span class="mi">22</span><span class="n">hvc</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">alias</span> <span class="n">kgetpods</span><span class="o">=</span><span class="s1">&#39;kubectl get pods&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## for example  kcuc dev-lab-odf-2   ||  kcuc dev-lab-odf-1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">alias</span> <span class="n">kcuc</span><span class="o">=</span><span class="s1">&#39;kubectl config use-context&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">alias</span> <span class="n">kcsc</span><span class="o">=</span><span class="s1">&#39;kubectl config set-context&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">alias</span> <span class="n">kcdc</span><span class="o">=</span><span class="s1">&#39;kubectl config delete-context&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">alias</span> <span class="n">kccc</span><span class="o">=</span><span class="s1">&#39;kubectl config current-context&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># List all contexts</span>
</span></span><span class="line"><span class="cl"><span class="n">alias</span> <span class="n">kcgc</span><span class="o">=</span><span class="s1">&#39;kubectl config get-contexts&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">alias</span> <span class="n">kcn</span><span class="o">=</span><span class="s1">&#39;kubectl config set-context --current --namespace&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">set</span> <span class="o">-</span><span class="n">ex</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">exec</span> <span class="n">odf_test</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">shared</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">cp</span> <span class="o">../../</span><span class="n">test_lib</span><span class="o">/</span> <span class="n">odf_test</span><span class="p">:</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">cp</span> <span class="o">../../</span><span class="n">acceptance_perf_soak</span><span class="o">/</span> <span class="n">odf_test</span><span class="p">:</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Create test result directory</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span> <span class="o">!</span> <span class="o">-</span><span class="n">d</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">perf_result</span> <span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">perf_result</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Executing the Actual Test</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">exec</span> <span class="o">-</span><span class="n">t</span> <span class="n">odf_test</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span> <span class="o">-</span><span class="n">lc</span> <span class="s1">&#39;nohup python3 -u -m pytest -s /app/acceptance_perf_soak/test_main_perf.py::test_perf_enrich_strategy_key | tee test_perf_enrich_strategy_key.log&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Saves the test logs and results in host machine</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">exec</span> <span class="o">-</span><span class="n">it</span> <span class="n">odf_test</span> <span class="n">bash</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;ls -1 *.log&#39;</span> <span class="o">|</span> <span class="n">tr</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span> <span class="o">|</span>  <span class="n">xargs</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">i</span> <span class="n">docker</span> <span class="n">cp</span> <span class="n">odf_test</span><span class="p">:</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="p">{}</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">perf_result</span><span class="o">/</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">exec</span> <span class="o">-</span><span class="n">it</span> <span class="n">odf_test</span> <span class="n">bash</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;(cd /tmp &amp;&amp; ls -1 *.csv)&#39;</span> <span class="o">|</span> <span class="n">tr</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span> <span class="o">|</span>  <span class="n">xargs</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">i</span> <span class="n">docker</span> <span class="n">cp</span> <span class="n">odf_test</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="p">{}</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">perf_result</span><span class="o">/</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">set</span> <span class="o">+</span><span class="n">x</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">To</span> <span class="n">elaborate</span> <span class="n">the</span> <span class="n">issue</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">I</span> <span class="n">am</span> <span class="n">running</span> <span class="n">a</span> <span class="n">perf</span> <span class="n">test</span> <span class="n">ngm</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">container</span><span class="o">/</span><span class="n">acceptance_perf_soak</span><span class="o">/</span><span class="n">perf</span><span class="o">/</span><span class="n">e2e_enrich_key</span><span class="o">.</span> <span class="n">For</span> <span class="n">which</span> <span class="n">I</span> <span class="n">had</span> <span class="n">updated</span> <span class="n">the</span> <span class="n">test</span> <span class="n">script</span> <span class="n">ngm</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">container</span><span class="o">/</span><span class="n">acceptance_perf_soak</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">run_test_enrich_strategy_key_k8s</span><span class="o">.</span><span class="n">sh</span> <span class="n">with</span> <span class="n">below</span> <span class="n">updates</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Text</span>
</span></span><span class="line"><span class="cl"><span class="n">set</span> <span class="o">-</span><span class="n">ex</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">exec</span> <span class="n">odf</span><span class="o">-</span><span class="n">test</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">shared</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">cp</span> <span class="o">../</span><span class="n">test_lib</span><span class="o">/</span> <span class="n">odf</span><span class="o">-</span><span class="n">test</span><span class="p">:</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">cp</span> <span class="o">../</span><span class="n">acceptance_perf_soak</span><span class="o">/</span> <span class="n">odf</span><span class="o">-</span><span class="n">test</span><span class="p">:</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Create test result directory</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span> <span class="o">!</span> <span class="o">-</span><span class="n">d</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">perf_result</span> <span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">perf_result</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Executing the Actual Test</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">exec</span> <span class="o">-</span><span class="n">t</span> <span class="n">odf</span><span class="o">-</span><span class="n">test</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span> <span class="o">-</span><span class="n">lc</span> <span class="s1">&#39;nohup python3 -u -m pytest -s /app/acceptance_perf_soak/test_main_perf.py::test_perf_enrich_strategy_key | tee test_perf_enrich_strategy_key.log&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Saves the test logs and results in host machine</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">exec</span> <span class="o">-</span><span class="n">it</span> <span class="n">odf</span><span class="o">-</span><span class="n">test</span> <span class="n">bash</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;ls -1 *.log&#39;</span> <span class="o">|</span> <span class="n">tr</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span> <span class="o">|</span>  <span class="n">xargs</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">i</span> <span class="n">docker</span> <span class="n">cp</span> <span class="n">odf</span><span class="o">-</span><span class="n">test</span><span class="p">:</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="p">{}</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">perf_result</span><span class="o">/</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">exec</span> <span class="o">-</span><span class="n">it</span> <span class="n">odf</span><span class="o">-</span><span class="n">test</span> <span class="n">bash</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;(cd /tmp &amp;&amp; ls -1 *.csv)&#39;</span> <span class="o">|</span> <span class="n">tr</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span> <span class="o">|</span>  <span class="n">xargs</span> <span class="o">-</span><span class="n">n1</span> <span class="o">-</span><span class="n">i</span> <span class="n">docker</span> <span class="n">cp</span> <span class="n">odf</span><span class="o">-</span><span class="n">test</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="p">{}</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">perf_result</span><span class="o">/</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">set</span> <span class="o">+</span><span class="n">x</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="n">And</span> <span class="n">before</span> <span class="n">I</span> <span class="n">ran</span> <span class="n">the</span> <span class="n">script</span><span class="p">,</span> <span class="n">I</span> <span class="n">executed</span> <span class="n">script</span> <span class="s1">&#39;ngm-test-container/resources/scripts/minikube/install_odf_minikube_perf_assembly.sh&#39;</span> <span class="n">And</span> <span class="n">then</span> <span class="n">I</span> <span class="n">get</span> <span class="n">sftp</span><span class="p">,</span> <span class="n">odf</span><span class="o">-</span><span class="n">test</span> <span class="ow">and</span> <span class="n">strimzi</span><span class="o">-</span><span class="n">cluster</span> <span class="n">pod</span> <span class="n">up</span><span class="o">.</span> <span class="n">In</span> <span class="n">the</span> <span class="n">script</span><span class="p">,</span> <span class="n">I</span> <span class="n">set</span> <span class="n">the</span> <span class="n">variable</span> <span class="n">minikube</span> <span class="n">as</span> <span class="bp">true</span> <span class="n">since</span> <span class="n">I</span> <span class="n">am</span> <span class="n">running</span> <span class="n">the</span> <span class="n">test</span> <span class="n">on</span> <span class="n">local</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="n">And</span> <span class="n">then</span> <span class="n">to</span> <span class="n">get</span> <span class="n">the</span> <span class="n">pods</span> <span class="n">kafka</span><span class="p">,</span> <span class="n">zookeeper</span><span class="p">,</span> <span class="n">SR</span><span class="p">,</span> <span class="n">streamer</span> <span class="n">etc</span><span class="o">.</span> <span class="n">up</span><span class="p">,</span> <span class="n">I</span> <span class="n">executed</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">helm</span> <span class="n">upgrade</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">n</span> <span class="n">cgf</span> <span class="n">odf</span><span class="o">-</span><span class="n">assembly</span><span class="o">-</span><span class="n">test</span> <span class="o">--</span><span class="n">version</span><span class="o">=</span><span class="mf">2.8</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="n">SNAPSHOT</span> <span class="n">openet</span><span class="o">-</span><span class="n">helm</span><span class="o">/</span><span class="n">odf</span><span class="o">-</span><span class="n">assembly</span> <span class="o">-</span><span class="n">f</span> <span class="o">./</span><span class="n">perf</span><span class="o">/</span><span class="n">e2e_enrich_key</span><span class="o">/</span><span class="n">assembly</span><span class="o">-</span><span class="n">values</span><span class="o">-</span><span class="n">local</span><span class="o">.</span><span class="n">yaml</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="n">In</span> <span class="n">assembly</span><span class="o">-</span><span class="n">value</span><span class="o">-</span><span class="n">local</span><span class="o">.</span><span class="n">yaml</span> <span class="n">file</span><span class="p">,</span> <span class="n">I</span> <span class="n">have</span> <span class="n">given</span> <span class="n">tag</span> <span class="k">for</span> <span class="n">odf</span><span class="o">-</span><span class="n">streamer</span> <span class="n">as</span> <span class="mf">2.9</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">SNAPSHOT</span> <span class="p">(</span><span class="mf">2.9</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">SNAPSHOT</span> <span class="n">also</span><span class="p">),</span> <span class="n">strimizi</span> <span class="n">connect</span> <span class="n">package</span> <span class="n">as</span> <span class="mf">2.9</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">SNAPSHOT</span> <span class="ow">and</span> <span class="n">all</span> <span class="n">pods</span><span class="p">,</span> <span class="n">gave</span> <span class="n">enabled</span><span class="p">:</span> <span class="bp">true</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">5.</span> <span class="n">In</span> <span class="n">the</span> <span class="n">test</span> <span class="n">file</span> <span class="p">(</span><span class="n">test_config_perf_e2e_enrich_key</span><span class="o">.</span><span class="n">yaml</span><span class="p">),</span> <span class="n">I</span> <span class="n">provided</span> <span class="n">chart</span> <span class="n">version</span> <span class="n">as</span> <span class="mf">2.8</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="n">SNAPSHOT</span> <span class="k">for</span> <span class="n">odf</span><span class="o">-</span><span class="n">assembly</span><span class="o">-</span><span class="n">test</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">But</span> <span class="n">still</span><span class="p">,</span> <span class="n">I</span> <span class="n">am</span> <span class="ow">not</span> <span class="n">getting</span> <span class="n">the</span> <span class="n">streamer</span> <span class="n">pod</span> <span class="n">up</span><span class="o">.</span> <span class="n">Please</span> <span class="n">help</span> <span class="k">if</span> <span class="n">I</span> <span class="n">am</span> <span class="n">still</span> <span class="n">missing</span> <span class="n">something</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">docker</span> <span class="n">exec</span> <span class="o">-</span><span class="n">ti</span> <span class="n">odf_test</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&#34;export ODF_TEST_ENV=&#34;</span><span class="n">k8s</span><span class="s2">&#34;;pytest -s /app/acceptance_perf_soak/test_main_perf_collect_data.py::test_perf_collect_data_streamer&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
  </div>
</article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="https://yao.lu.1223@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://www.linkedin.com/in/yao-lu93" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="https://github.com/yaolu93" class="iconfont icon-github" title="github"></a>
  <a href="https://www.yaolugnu.com/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2020 - 
    2024<span class="heart"><i class="iconfont icon-heart"></i></span><span>Yao</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
